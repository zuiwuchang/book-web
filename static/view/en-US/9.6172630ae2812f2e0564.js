(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{zFnc:function(e,t,n){"use strict";n.r(t),n.d(t,"EditModule",function(){return Ie});var a=n("ofXK"),i=n("TVeG"),r=n("tyNb"),l=n("WIkj"),o=n("1G5W"),c=n("yUmd"),d=n("mrSG"),s=n("W37J"),m=n("UXTw");class p{constructor(){}static getItems(){return p.items||(p.items=["\\","`","*","_","{","}","[","]","(",")","#","+","-",".","!"].map(function(e){return{escape:new RegExp("\\"+e,"g"),escapeVal:"\\"+e,unescape:new RegExp("\\\\\\"+e,"g"),unescapeVal:e}})),p.items}static escape(e){if("string"!=typeof e)return e;const t=p.getItems();for(let a=0;a<t.length;a++){const n=t[a];e=e.replace(n.escape,n.escapeVal)}return(n=e)&&0!=n.length?n=(n=(n=(n=(n=(n=n.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/ /g,"&nbsp;")).replace(/\'/g,"&#39;")).replace(/\"/g,"&quot;"):"";var n}static unescape(e){if("string"!=typeof e)return e;const t=p.getItems();for(let a=t.length-1;a>=0;a--){const n=t[a];e=e.replace(n.unescape,n.unescapeVal)}return(n=e)&&0!=n.length?n=(n=(n=(n=(n=(n=n.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&nbsp;/g," ")).replace(/&#39;/g,"'")).replace(/&quot;/g,'"'):"";var n}}var u=n("w5zv"),h=n("PqYM"),f=n("fXoL"),b=n("0IaG"),v=n("3Pt+"),g=n("kmnG"),S=n("qFsG"),C=n("chBE"),E=n("bTqV");let y=(()=>{class e{constructor(e){this.dialogRef=e,this.data={id:"",name:""}}ngOnInit(){}onCancel(){this.dialogRef.close()}onSure(){this.dialogRef.close({id:this.data.id,name:this.data.name})}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-new-chapter"]],decls:20,vars:4,consts:function(){let e,t,n,a,i,r,l;return e="New",t="Please enter chapter name",n="Invalid chapter name",a="Please enter chapter ID",i="Invalid ID",r="Sure",l="Cancel",[[3,"submit"],["form","ngForm"],["mat-dialog-title",""],e,["mat-dialog-content",""],[1,"full-width"],["matInput","","required","","name","name","placeholder",t,3,"ngModel","ngModelChange"],["valName","ngModel"],n,["matInput","","name","id","placeholder",a,3,"sharedValidatorId","ngModel","ngModelChange"],i,["mat-dialog-actions",""],["type","submit","mat-button","",3,"disabled"],r,["type","button","mat-button","",3,"click"],l]},template:function(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"form",0,1),f["\u0275\u0275listener"]("submit",function(){return t.onSure()}),f["\u0275\u0275elementStart"](2,"h1",2),f["\u0275\u0275i18n"](3,3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"div",4),f["\u0275\u0275elementStart"](5,"mat-form-field",5),f["\u0275\u0275elementStart"](6,"input",6,7),f["\u0275\u0275listener"]("ngModelChange",function(e){return t.data.name=e}),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](8,"mat-error"),f["\u0275\u0275i18n"](9,8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](10,"mat-form-field",5),f["\u0275\u0275elementStart"](11,"input",9,7),f["\u0275\u0275listener"]("ngModelChange",function(e){return t.data.id=e}),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](13,"mat-error"),f["\u0275\u0275i18n"](14,10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](15,"div",11),f["\u0275\u0275elementStart"](16,"button",12),f["\u0275\u0275i18n"](17,13),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](18,"button",14),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](19,15),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275reference"](1);f["\u0275\u0275advance"](6),f["\u0275\u0275property"]("ngModel",t.data.name),f["\u0275\u0275advance"](5),f["\u0275\u0275property"]("sharedValidatorId",!0)("ngModel",t.data.id),f["\u0275\u0275advance"](5),f["\u0275\u0275property"]("disabled",e.invalid)}},directives:[v.n,v.j,v.k,b.g,b.d,g.c,S.a,v.b,v.m,v.i,v.l,g.b,C.a,b.c,E.a],styles:[""]}),e})(),x=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}ngOnInit(){}onCancel(){this.dialogRef.close()}onSure(){this.dialogRef.close({id:this.data.id,name:this.data.name})}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](b.f),f["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-edit-chapter"]],decls:20,vars:3,consts:function(){let e,t,n,a,i,r,l;return e="Modify",t="Please enter chapter name",n="Invalid chapter name",a="Please enter chapter ID",i="Invalid ID",r="Sure",l="Cancel",[[3,"submit"],["form","ngForm"],["mat-dialog-title",""],e,["mat-dialog-content",""],[1,"full-width"],["matInput","","required","","name","name","placeholder",t,3,"ngModel","ngModelChange"],["valName","ngModel"],n,["matInput","","name","id","placeholder",a,3,"sharedValidatorId","ngModel","ngModelChange"],i,["mat-dialog-actions",""],["type","submit","mat-button","",3,"disabled"],r,["type","button","mat-button","",3,"click"],l]},template:function(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"form",0,1),f["\u0275\u0275listener"]("submit",function(){return t.onSure()}),f["\u0275\u0275elementStart"](2,"h1",2),f["\u0275\u0275i18n"](3,3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"div",4),f["\u0275\u0275elementStart"](5,"mat-form-field",5),f["\u0275\u0275elementStart"](6,"input",6,7),f["\u0275\u0275listener"]("ngModelChange",function(e){return t.data.name=e}),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](8,"mat-error"),f["\u0275\u0275i18n"](9,8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](10,"mat-form-field",5),f["\u0275\u0275elementStart"](11,"input",9,7),f["\u0275\u0275listener"]("ngModelChange",function(e){return t.data.id=e}),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](13,"mat-error"),f["\u0275\u0275i18n"](14,10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](15,"div",11),f["\u0275\u0275elementStart"](16,"button",12),f["\u0275\u0275i18n"](17,13),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](18,"button",14),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](19,15),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275reference"](1);f["\u0275\u0275advance"](6),f["\u0275\u0275property"]("ngModel",t.data.name),f["\u0275\u0275advance"](5),f["\u0275\u0275property"]("ngModel",t.data.id),f["\u0275\u0275advance"](5),f["\u0275\u0275property"]("disabled",e.invalid)}},directives:[v.n,v.j,v.k,b.g,b.d,g.c,S.a,v.b,v.m,v.i,v.l,g.b,C.a,b.c,E.a],styles:[""]}),e})(),w=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}ngOnInit(){}onCancel(){this.dialogRef.close()}onSure(){this.dialogRef.close(!0)}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](b.f),f["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-remove-chapter"]],decls:12,vars:2,consts:function(){let e,t,n,a;return e="Delete chapter",t="The chapter deletion cannot be recovered. Are you sure you want to delete \"" + "\ufffd0\ufffd" + "\"?",n="Sure",a="Cancel",[[3,"submit"],["form","ngForm"],["mat-dialog-title",""],e,["mat-dialog-content",""],t,["mat-dialog-actions",""],["type","submit","mat-button","",3,"disabled"],n,["type","button","cdkFocusInitial","","mat-button","",3,"click"],a]},template:function(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"form",0,1),f["\u0275\u0275listener"]("submit",function(){return t.onSure()}),f["\u0275\u0275elementStart"](2,"h1",2),f["\u0275\u0275i18n"](3,3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"p",4),f["\u0275\u0275elementContainerStart"](5),f["\u0275\u0275i18n"](6,5),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](7,"div",6),f["\u0275\u0275elementStart"](8,"button",7),f["\u0275\u0275i18n"](9,8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](10,"button",9),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](11,10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275reference"](1);f["\u0275\u0275advance"](6),f["\u0275\u0275i18nExp"](t.data.name),f["\u0275\u0275i18nApply"](6),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("disabled",e.invalid)}},directives:[v.n,v.j,v.k,b.g,b.d,b.c,E.a],styles:[""]}),e})();var k=n("7pIB"),I=n("RskC"),O=n("MutI"),j=n("bv9b"),R=n("FKr1"),M=n("Qu3c"),z=n("NFeN");function _(e,t){1&e&&f["\u0275\u0275element"](0,"mat-icon",27)}function F(e,t){1&e&&f["\u0275\u0275element"](0,"mat-icon",28)}function P(e,t){1&e&&f["\u0275\u0275element"](0,"mat-icon",29)}function T(e,t){1&e&&f["\u0275\u0275element"](0,"mat-icon",30)}function D(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"mat-list-item"),f["\u0275\u0275elementStart"](1,"p",19),f["\u0275\u0275text"](2),f["\u0275\u0275template"](3,_,1,0,"mat-icon",20),f["\u0275\u0275template"](4,F,1,0,"mat-icon",21),f["\u0275\u0275template"](5,P,1,0,"mat-icon",22),f["\u0275\u0275template"](6,T,1,0,"mat-icon",23),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](7,"p",19),f["\u0275\u0275text"](8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](9,"p",19),f["\u0275\u0275element"](10,"mat-progress-bar",9),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](11,"button",24),f["\u0275\u0275listener"]("click",function(){return t.$implicit.upload()}),f["\u0275\u0275elementStart"](12,"mat-icon"),f["\u0275\u0275text"](13,"cloud_upload"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](14,"button",25),f["\u0275\u0275listener"]("click",function(){return t.$implicit.cancel()}),f["\u0275\u0275elementStart"](15,"mat-icon"),f["\u0275\u0275text"](16,"cancel"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](17,"button",26),f["\u0275\u0275listener"]("click",function(){return t.$implicit.remove()}),f["\u0275\u0275elementStart"](18,"mat-icon"),f["\u0275\u0275text"](19,"delete"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate1"](" ",null==e||null==e.file?null:e.file.name," "),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",e.isSuccess),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",e.isCancel),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",e.isError),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",e.isUploading),f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate"](n.getSize(null==e||null==e.file?null:e.file.size)),f["\u0275\u0275advance"](2),f["\u0275\u0275propertyInterpolate"]("value",e.progress),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("disabled",e.isReady||e.isUploading||e.isSuccess),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",!e.isUploading)}}const N=function(e){return{"another-file-over-class":e}},A=1048576,V=1024*A;let q=(()=>{class e{constructor(e,t,n){this.sessionService=e,this.dialogRef=t,this.data=n,this.hasBaseDropZoneOver=!1,this.hasAnotherDropZoneOver=!1}ngOnInit(){this.uploader=new k.d({url:"/api/v1/assets/upload/"+this.data.book+"/"+this.data.chapter,headers:[{name:"token",value:this.sessionService.token()}]})}onCancel(){this.dialogRef.close()}fileOverBase(e){this.hasBaseDropZoneOver=e,console.log(e)}fileOverAnother(e){this.hasAnotherDropZoneOver=e,console.log(e)}getSize(e){return e>V?(e/V).toFixed(2)+" GB":e>A?(e/A).toFixed(2)+" MB":e>1024?(e/1024).toFixed(2)+" KB":e+" B"}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](I.a),f["\u0275\u0275directiveInject"](b.f),f["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-file-upload"]],decls:30,vars:12,consts:function(){let e,t,n,a,i,r,l,o,c,d;return e="File upload",t="Queue length",n="Select files",a="Upload all",i="Cancel all of them",r="Clear All",l="Cancel",o="Upload",c="Cancel",d="Remove",[["mat-dialog-title",""],e,["mat-dialog-content",""],["ng2FileDrop","",1,"well","my-drop-zone",3,"ngClass","uploader","fileOver"],[1,"view"],["type","file","name","filename","ng2FileSelect","","multiple","",1,"hide",3,"uploader"],["file",""],t,[4,"ngFor","ngForOf"],["mode","determinate",3,"value"],["mat-button","",1,"no-outline",3,"click"],n,["mat-button","",1,"no-outline",3,"disabled","click"],a,i,r,["mat-dialog-actions",""],["type","button","mat-button","",3,"disabled","click"],l,["matLine",""],["fontSet","fas","fontIcon","fa-check-square","color","primary",4,"ngIf"],["fontSet","fas","fontIcon","fa-ban","color","accent",4,"ngIf"],["fontSet","fas","fontIcon","fa-exclamation-triangle","color","warn",4,"ngIf"],["fontSet","fas","fontIcon","fa-spinner","color","primary",4,"ngIf"],["mat-icon-button","","matTooltip",o,1,"no-outline",3,"disabled","click"],["mat-icon-button","","matTooltip",c,1,"no-outline",3,"disabled","click"],["mat-icon-button","","matTooltip",d,1,"no-outline",3,"click"],["fontSet","fas","fontIcon","fa-check-square","color","primary"],["fontSet","fas","fontIcon","fa-ban","color","accent"],["fontSet","fas","fontIcon","fa-exclamation-triangle","color","warn"],["fontSet","fas","fontIcon","fa-spinner","color","primary"]]},template:function(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"h1",0),f["\u0275\u0275i18n"](1,1),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](2,"div",2),f["\u0275\u0275elementStart"](3,"div",3),f["\u0275\u0275listener"]("fileOver",function(e){return t.fileOverAnother(e)}),f["\u0275\u0275elementStart"](4,"div",4),f["\u0275\u0275element"](5,"input",5,6),f["\u0275\u0275elementContainerStart"](7),f["\u0275\u0275i18n"](8,7),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275text"](9),f["\u0275\u0275elementStart"](10,"mat-list"),f["\u0275\u0275template"](11,D,20,9,"mat-list-item",8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](12,"div"),f["\u0275\u0275elementStart"](13,"p"),f["\u0275\u0275element"](14,"mat-progress-bar",9),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](15,"p"),f["\u0275\u0275elementStart"](16,"button",10),f["\u0275\u0275listener"]("click",function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275reference"](6).click()}),f["\u0275\u0275i18n"](17,11),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](18,"button",12),f["\u0275\u0275listener"]("click",function(){return t.uploader.uploadAll()}),f["\u0275\u0275elementContainerStart"](19),f["\u0275\u0275i18n"](20,13),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](21,"button",12),f["\u0275\u0275listener"]("click",function(){return t.uploader.cancelAll()}),f["\u0275\u0275elementContainerStart"](22),f["\u0275\u0275i18n"](23,14),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](24,"button",12),f["\u0275\u0275listener"]("click",function(){return t.uploader.clearQueue()}),f["\u0275\u0275elementContainerStart"](25),f["\u0275\u0275i18n"](26,15),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](27,"div",16),f["\u0275\u0275elementStart"](28,"button",17),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](29,18),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()}2&e&&(f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngClass",f["\u0275\u0275pureFunction1"](10,N,t.hasAnotherDropZoneOver))("uploader",t.uploader),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("uploader",t.uploader),f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate1"](" : ",null==t.uploader||null==t.uploader.queue?null:t.uploader.queue.length," "),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("ngForOf",t.uploader.queue),f["\u0275\u0275advance"](3),f["\u0275\u0275propertyInterpolate"]("value",t.uploader.progress),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("disabled",!t.uploader.getNotUploadedItems().length),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",!t.uploader.isUploading),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",!t.uploader.queue.length),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("disabled",null==t.uploader?null:t.uploader.isUploading))},directives:[b.g,b.d,k.a,a.i,k.b,O.a,a.j,j.a,E.a,b.c,O.c,R.e,a.k,M.a,z.a],styles:[".view[_ngcontent-%COMP%]{padding:16px}.my-drop-zone[_ngcontent-%COMP%]{border:3px dotted #d3d3d3}.nv-file-over[_ngcontent-%COMP%]{border:3px dotted red}.another-file-over-class[_ngcontent-%COMP%]{border:3px dotted green}"]}),e})(),L=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}ngOnInit(){}onCancel(){this.dialogRef.close()}onSure(){this.dialogRef.close(!0)}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](b.f),f["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-remove-file"]],decls:12,vars:2,consts:function(){let e,t,n,a;return e="Delete file",t="File deletion cannot be recovered. Are you sure you want to delete \"" + "\ufffd0\ufffd" + "\"?",n="Sure",a="Cancel",[[3,"submit"],["form","ngForm"],["mat-dialog-title",""],e,["mat-dialog-content",""],t,["mat-dialog-actions",""],["type","submit","mat-button","",3,"disabled"],n,["type","button","cdkFocusInitial","","mat-button","",3,"click"],a]},template:function(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"form",0,1),f["\u0275\u0275listener"]("submit",function(){return t.onSure()}),f["\u0275\u0275elementStart"](2,"h1",2),f["\u0275\u0275i18n"](3,3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"p",4),f["\u0275\u0275elementContainerStart"](5),f["\u0275\u0275i18n"](6,5),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](7,"div",6),f["\u0275\u0275elementStart"](8,"button",7),f["\u0275\u0275i18n"](9,8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](10,"button",9),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](11,10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275reference"](1);f["\u0275\u0275advance"](6),f["\u0275\u0275i18nExp"](t.data),f["\u0275\u0275i18nApply"](6),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("disabled",e.invalid)}},directives:[v.n,v.j,v.k,b.g,b.d,b.c,E.a],styles:[""]}),e})(),Q=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}ngOnInit(){}onCancel(){this.dialogRef.close()}onSure(){this.dialogRef.close(this.data)}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](b.f),f["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-file-edit"]],decls:15,vars:2,consts:function(){let e,t,n,a,i;return e="File rename",t="Please enter a new file name",n="Invalid file name",a="Sure",i="Cancel",[["mat-dialog-title",""],e,["mat-dialog-content",""],["form","ngForm"],[1,"full-width"],["matInput","","required","","appValidatorsFileName","","name","filename","placeholder",t,3,"ngModel","ngModelChange"],["valName","ngModel"],n,["mat-dialog-actions",""],["type","button","mat-button","",3,"disabled","click"],a,["type","button","mat-button","",3,"click"],i]},template:function(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"h1",0),f["\u0275\u0275i18n"](1,1),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](2,"div",2),f["\u0275\u0275elementStart"](3,"form",null,3),f["\u0275\u0275elementStart"](5,"mat-form-field",4),f["\u0275\u0275elementStart"](6,"input",5,6),f["\u0275\u0275listener"]("ngModelChange",function(e){return t.data=e}),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](8,"mat-error"),f["\u0275\u0275i18n"](9,7),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](10,"div",8),f["\u0275\u0275elementStart"](11,"button",9),f["\u0275\u0275listener"]("click",function(){return t.onSure()}),f["\u0275\u0275i18n"](12,10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](13,"button",11),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](14,12),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275reference"](4);f["\u0275\u0275advance"](6),f["\u0275\u0275property"]("ngModel",t.data),f["\u0275\u0275advance"](5),f["\u0275\u0275property"]("disabled",e.invalid)}},directives:[b.g,b.d,v.n,v.j,v.k,g.c,S.a,v.b,v.m,v.i,v.l,g.b,b.c,E.a],styles:[""]}),e})();var U=n("ebYI"),W=n("tk/3"),B=n("9vru"),G=n("jeCx"),J=n("Xa2L");const K=["btnClipboard"];function X(e,t){1&e&&f["\u0275\u0275element"](0,"mat-spinner",10)}function H(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"mat-list-item"),f["\u0275\u0275elementStart"](1,"p",11),f["\u0275\u0275text"](2),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](3,"button",12),f["\u0275\u0275listener"]("click",function(){f["\u0275\u0275restoreView"](e);const n=t.$implicit;return f["\u0275\u0275nextContext"]().onCopy(n)}),f["\u0275\u0275elementStart"](4,"mat-icon"),f["\u0275\u0275text"](5,"add_box"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](6,"button",13),f["\u0275\u0275listener"]("click",function(){f["\u0275\u0275restoreView"](e);const n=t.$implicit;return f["\u0275\u0275nextContext"]().onRename(n)}),f["\u0275\u0275elementStart"](7,"mat-icon"),f["\u0275\u0275text"](8,"create"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](9,"button",14),f["\u0275\u0275listener"]("click",function(){f["\u0275\u0275restoreView"](e);const n=t.$implicit;return f["\u0275\u0275nextContext"]().onRemove(n)}),f["\u0275\u0275elementStart"](10,"mat-icon"),f["\u0275\u0275text"](11,"delete"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate1"]("assets/",e,""),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("disabled",n.disabled),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",n.disabled)}}let Z=(()=>{class e{constructor(e,t,n,a,i,r){this.dialogRef=e,this.data=t,this.httpClient=n,this.toasterService=a,this.matDialog=i,this.i18nService=r,this.disabled=!1,this.items=null,this.clipboard=null}ngOnInit(){this.Refresh()}ngOnDestroy(){this.clipboard&&this.clipboard.destroy()}onCancel(){this.dialogRef.close()}ngAfterViewInit(){Object(l.b)("clipboard").then(e=>{this.clipboard=new e(this.btnClipboard.nativeElement).on("success",()=>{this.toasterService.pop("success","",this.i18nService.get("data copied"))}).on("error",e=>{console.error("Action:",e.action),console.error("Trigger:",e.trigger)})})}Refresh(){this.disabled||(this.items=null,this.disabled=!0,u.a.v1.assets.get(this.httpClient,{params:{book:this.data.book,chapter:this.data.chapter}}).then(e=>{this.disabled=!1,this.items=e,console.log(e)},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.disabled=!1}))}onRemove(e){this.disabled?console.log("disabled,ignore remove"):this.matDialog.open(L,{width:"80%",maxWidth:800,data:e}).afterClosed().toPromise().then(t=>{t&&(this.disabled=!0,u.a.v1.assets.delete(this.httpClient,{params:{book:this.data.book,chapter:this.data.chapter,filename:e}}).then(()=>{this.toasterService.pop("success",void 0,this.i18nService.get("File deleted"));const t=this.items.indexOf(e);-1!=t&&this.items.splice(t,1)},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.disabled=!1}))})}onCopy(e){this.btnClipboard.nativeElement.setAttribute("data-clipboard-text","assets/"+e),this.btnClipboard.nativeElement.click()}onRename(e){this.disabled?console.log("disabled,ignore rename"):this.matDialog.open(Q,{width:"80%",maxWidth:800,data:e}).afterClosed().toPromise().then(t=>{Object(U.isString)(t)&&t!=e&&(this.disabled=!0,u.a.v1.assets.putOne(this.httpClient,"name",{book:this.data.book,chapter:this.data.chapter,source:e,target:t}).then(()=>{this.toasterService.pop("success",void 0,this.i18nService.get("File renamed"));const n=this.items.indexOf(e);-1!=n&&(this.items[n]=t)},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.disabled=!1}))})}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](b.f),f["\u0275\u0275directiveInject"](b.a),f["\u0275\u0275directiveInject"](W.b),f["\u0275\u0275directiveInject"](B.d),f["\u0275\u0275directiveInject"](b.b),f["\u0275\u0275directiveInject"](G.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-file-management"]],viewQuery:function(e,t){if(1&e&&f["\u0275\u0275viewQuery"](K,1),2&e){let e;f["\u0275\u0275queryRefresh"](e=f["\u0275\u0275loadQuery"]())&&(t.btnClipboard=e.first)}},decls:13,vars:3,consts:function(){let e,t,n,a,i;return e="File management",t="Cancel",n="Copy",a="Edit",i="Delete",[["data-clipboard-text","",1,"hide"],["btnClipboard",""],["mat-dialog-title",""],e,["color","accent","diameter","32",4,"ngIf"],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["type","button","mat-button","",3,"disabled","click"],t,["color","accent","diameter","32"],["matLine",""],["mat-icon-button","","matTooltip",n,1,"menu-btn",3,"click"],["mat-icon-button","","matTooltip",a,1,"menu-btn",3,"disabled","click"],["mat-icon-button","","matTooltip",i,1,"menu-btn",3,"disabled","click"]]},template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"button",0,1),f["\u0275\u0275text"](2,"copy"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](3,"h1",2),f["\u0275\u0275elementContainerStart"](4),f["\u0275\u0275i18n"](5,3),f["\u0275\u0275elementContainerEnd"](),f["\u0275\u0275template"](6,X,1,0,"mat-spinner",4),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](7,"div",5),f["\u0275\u0275elementStart"](8,"mat-list"),f["\u0275\u0275template"](9,H,12,3,"mat-list-item",6),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](10,"div",7),f["\u0275\u0275elementStart"](11,"button",8),f["\u0275\u0275listener"]("click",function(){return t.onCancel()}),f["\u0275\u0275i18n"](12,9),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e&&(f["\u0275\u0275advance"](6),f["\u0275\u0275property"]("ngIf",t.disabled),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngForOf",t.items),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("disabled",t.disabled))},directives:[b.g,a.k,b.d,O.a,a.j,b.c,E.a,J.b,O.c,R.e,M.a,z.a],styles:[".view[_ngcontent-%COMP%]{padding-top:16px}.clipboard-view[_ngcontent-%COMP%]{position:fixed;top:-1000px}.mat-spinner[_ngcontent-%COMP%]{display:inline;margin-left:8px}"]}),e})();var Y=n("NKdq"),ee=n("FWHW"),te=n("XhcP"),ne=n("f0Cb"),ae=n("PQoX"),ie=n("obgt");const re=["view"],le=["btnClipboard"],oe=["textarea"],ce=function(e,t){return["/edit",e,t]};function de(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"a",3),f["\u0275\u0275elementStart"](1,"p",18),f["\u0275\u0275text"](2),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](3,"button",19),f["\u0275\u0275listener"]("click",function(n){f["\u0275\u0275restoreView"](e);const a=t.$implicit,i=f["\u0275\u0275nextContext"]();return i.onChapterEdit(n,i.book,a)}),f["\u0275\u0275elementStart"](4,"mat-icon"),f["\u0275\u0275text"](5,"edit"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](6,"button",20),f["\u0275\u0275listener"]("click",function(n){f["\u0275\u0275restoreView"](e);const a=t.$implicit,i=f["\u0275\u0275nextContext"]();return i.onChapterRemove(n,i.book,a)}),f["\u0275\u0275elementStart"](7,"mat-icon"),f["\u0275\u0275text"](8,"delete"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=f["\u0275\u0275nextContext"]();f["\u0275\u0275property"]("routerLink",f["\u0275\u0275pureFunction2"](4,ce,null==n.book?null:n.book.id,e.id)),f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate"](e.name),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("disabled",n.disabled),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",n.disabled)}}function se(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"a",21),f["\u0275\u0275elementStart"](1,"button",22),f["\u0275\u0275elementStart"](2,"mat-icon"),f["\u0275\u0275text"](3,"navigate_before"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](4),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275property"]("routerLink",f["\u0275\u0275pureFunction2"](2,ce,e.previous.book,e.previous.chapter)),f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate1"](" ",e.previous.name," ")}}function me(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"a",21),f["\u0275\u0275elementStart"](1,"button",23),f["\u0275\u0275text"](2),f["\u0275\u0275elementStart"](3,"mat-icon"),f["\u0275\u0275text"](4,"navigate_next"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275property"]("routerLink",f["\u0275\u0275pureFunction2"](2,ce,e.next.book,e.next.chapter)),f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate1"](" ",e.next.name," ")}}const pe=function(e){return["/edit",e,"0"]};class ue{constructor(e,t,n){this.book=e,this.chapter=t,this.name=n}}class he{}let fe=(()=>{class e{constructor(e,t,n,a,i,r,o){this.settingsService=e,this.i18nService=t,this.highlightJsService=n,this.toasterService=a,this.router=i,this.httpClient=r,this.matDialog=o,this.closed_=new l.a,this.previewCache_=new he,this.oldText="",this.chapter=!1,this.header=!1,this.update_=!1,this.fullscreen=!1,this.textarea=null,this.readyEdit=!1,this.waitSave=!1,this.disabled=!1}set loader(e){const t=e.opened,n=e.book;this.book=n,this._initNavigate(n,t.chapter),this.update_=!0,this.oldText=e.text,this.opened=t}ngOnInit(){this.settingsService.chapterObservable.pipe(Object(o.a)(this.closed_.observable)).subscribe(e=>{this.chapter=e}),this.settingsService.headerObservable.pipe(Object(o.a)(this.closed_.observable)).subscribe(e=>{this.header=e}),this.settingsService.fullscreenObservable.pipe(Object(o.a)(this.closed_.observable)).subscribe(e=>{this.fullscreen=e}),Object(h.a)(1e3,1e3).pipe(Object(o.a)(this.closed_.observable)).subscribe(()=>{this.textarea&&(this.settingsService.isPreviewActive=this.textarea.isPreviewActive())})}ngOnDestroy(){this.closed_.close(),this.fullscreen=!1,this.clipboard&&this.clipboard.destroy(),this.elementRef.nativeElement&&$(this.elementRef.nativeElement).undelegate(".ng-router-a","click")}_initNavigate(e,t){if(e&&e.chapter&&0!=e.chapter.length)if(this.previous=null,this.next=null,"0"!=t){for(let n=0;n<e.chapter.length;n++)if(e.chapter[n].id==t){this.previous=0==n?new ue(e.id,"0",e.name):new ue(e.id,e.chapter[n-1].id,e.chapter[n-1].name),n+1<e.chapter.length&&(this.next=new ue(e.id,e.chapter[n+1].id,e.chapter[n+1].name));break}}else this.next=new ue(e.id,e.chapter[0].id,e.chapter[0].name)}onChange(e){if(!this.elementRef||!this.elementRef.nativeElement)return;const t=this.elementRef.nativeElement.querySelector("#"+e);t&&window.scroll({top:t.offsetTop,behavior:"smooth"})}ngAfterViewInit(){Object(l.b)("clipboard").then(e=>{this.clipboard=new e(this.btnClipboard.nativeElement).on("success",()=>{this.toasterService.pop("info","",this.i18nService.get("copyied"))}).on("error",e=>{console.error("Action:",e.action),console.error("Trigger:",e.trigger)})}),$(this.elementRef.nativeElement).delegate(".ng-router-a","click",e=>{const t=$(e.target).attr("href");return!!t.startsWith("/book/assets")||(this.router.navigate([t]),!1)}),this._initSimpleMDE()}_initSimpleMDE(){return Object(d.a)(this,void 0,void 0,function*(){const e=yield Object(l.b)("showdown"),t=yield Object(l.b)("simplemde");this.textarea=new t({autoDownloadFontAwesome:!1,element:this.textareaRef.nativeElement,previewRender:(t,n)=>{if(this.previewCache_.val==t)return this.update_=!0,this.previewCache_.preview;const a=this.opened;return this.markdown=new s.a(e,null,a.book,a.chapter,t),this.previewCache_.preview=this.markdown.HTML,this.update_=!0,this.markdown.HTML},spellChecker:!1,hideIcons:["guide"],showIcons:["code","table"],toolbar:[{name:"save",className:"fas fa-save",title:"Save (Ctrl-S)",action:e=>{this.saveDocument(e.value())}},"|",{name:"file-management",className:"fas fa-upload",title:"File management",action:e=>{this.matDialog.open(Z,{width:"80%",maxWidth:800,data:this.opened,disableClose:!0})}},{name:"file-upload",className:"fas fa-file-upload",title:"File upload",action:e=>{this.matDialog.open(q,{width:"80%",maxWidth:800,data:this.opened,disableClose:!0})}},"|","bold","italic","|","code","quote","|",{name:"markdown escape",className:"fas fa-angle-double-right",title:"Markdown Escape (Ctrl-M)",action:e=>{const t=e.codemirror;let n=t.getSelection();n=p.escape(n),t.replaceSelection(n,"around")}},{name:"markdown unescape",className:"fas fa-angle-double-left",title:"Markdown Unescape (Ctrl-Alt-M)",action:e=>{const t=e.codemirror;let n=t.getSelection();n=p.unescape(n),t.replaceSelection(n,"around")}},"|","unordered-list","ordered-list","|","link",{name:"image",className:"fa fa-image",title:"Insert Image",action:t.drawImage},"table","|","preview","side-by-side","fullscreen"]});const n=this.textarea.codemirror,a=n.getOption("extraKeys");a["Ctrl-S"]=()=>{this.saveDocument(this.textarea.value())},a["Ctrl-Enter"]=e=>{const t=e.getDoc(),n=t.getCursor(),a=t.getLine(n.line);t.replaceRange("\n",{line:n.line,ch:a.length}),t.setCursor({line:n.line+1,ch:0})},a["Ctrl-M"]=e=>{let t=e.getSelection();t=p.escape(t),e.replaceSelection(t,"around")},a["Ctrl-Alt-M"]=e=>{let t=e.getSelection();t=p.unescape(t),e.replaceSelection(t,"around")},n.setOption("extraKeys",a),this.textarea.value(this.oldText),this.textarea.codemirror.on("refresh",(e,t,n)=>{this.settingsService.fullscreen=this.textarea.isFullscreenActive()}),this.settingsService.isPreviewActive&&this.textarea.togglePreview(),this.readyEdit=!0})}ngAfterViewChecked(){if(!this.update_)return;this.update_=!1;const e=this.elementRef.nativeElement.querySelectorAll("code");if(e&&0!=e.length)for(let t=0;t<e.length;t++){const n=e[t];this.highlightJsService.highlight(n),!n.parentElement||"pre"!=n.parentElement.tagName&&"PRE"!=n.parentElement.tagName||this.createClipboard(n.parentElement,n)}Object(m.a)()}createClipboard(e,t){e.classList.add("code-view");const n=document.createElement("i");n.classList.add("fas"),n.classList.add("fa-copy"),n.classList.add("clipboard"),n.onclick=()=>{this.btnClipboard.nativeElement.setAttribute("data-clipboard-text",$(t).text().replace(/\xa0/g," ").trim()),this.btnClipboard.nativeElement.click()},t.appendChild(n)}saved(){return!this.textarea||this.textarea.value()==this.oldText||(this.toasterService.pop("error",void 0,this.i18nService.get("not saved")),!1)}saveDocument(e){if(e==this.oldText)return void this.toasterService.pop("warning","",this.i18nService.get("not changed"));if(this.waitSave)return void this.toasterService.pop("error","",this.i18nService.get("waiting save"));this.waitSave=!0;const t=this.opened;u.a.v1.text.put(this.httpClient,{book:t.book,chapter:t.chapter,text:e}).then(()=>{this.oldText=e,this.toasterService.pop("success",void 0,this.i18nService.get("save success"))},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.waitSave=!1})}onChapterSort(e){if(this.disabled)return;if(!e||!e.chapter||e.chapter.length<2)return;const t=[];for(let n=0;n<e.chapter.length;n++)t.push(e.chapter[n].id);this.disabled=!0,u.a.v1.chapters.putOne(this.httpClient,"sort",{book:e.id,chapters:t}).then(()=>{this.toasterService.pop("success",void 0,this.i18nService.get("save sort success"))},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.disabled=!1})}onChapterNew(){return Object(d.a)(this,void 0,void 0,function*(){if(this.disabled)return;const e=yield this.matDialog.open(y,{width:"80%",maxWidth:800}).afterClosed().toPromise();if(e){this.disabled=!0;try{e.id=yield u.a.v1.chapters.post(this.httpClient,{book:this.opened.book,id:e.id,name:e.name}),this.book.chapter||(this.book.chapter=new Array),this.book.chapter.push(e),this.toasterService.pop("success",void 0,this.i18nService.get("new chapter success"))}catch(t){this.toasterService.pop("error",void 0,t)}finally{this.disabled=!1}}})}onChapterEdit(e,t,n){return e.stopPropagation(),!(!t||!t.chapter||0==t.chapter.length||(this.disabled||this.matDialog.open(x,{width:"80%",maxWidth:800,data:{id:n.id,name:n.name}}).afterClosed().toPromise().then(e=>{e&&(e.id==n.id&&e.name==n.name||(this.disabled=!0,u.a.v1.chapters.put(this.httpClient,{book:t.id,chapter:n.id,id:e.id,name:e.name}).then(()=>{n.id=e.id,n.name=e.name,this.toasterService.pop("success",void 0,this.i18nService.get("save chapter success"))},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.disabled=!1})))}),1))}onChapterRemove(e,t,n){return e.stopPropagation(),!(!t||!t.chapter||0==t.chapter.length||(this.disabled||this.matDialog.open(w,{width:"80%",maxWidth:800,data:n}).afterClosed().toPromise().then(e=>{e&&(this.disabled=!0,u.a.v1.chapters.delete(this.httpClient,{params:{book:t.id,chapter:n.id}}).then(()=>{this.toasterService.pop("success",void 0,this.i18nService.get("remove chapter success"));const e=t.chapter.indexOf(n);-1!=e&&t.chapter.splice(e,1)},e=>{this.toasterService.pop("error",void 0,e)}).finally(()=>{this.disabled=!1}))}),1))}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](Y.b),f["\u0275\u0275directiveInject"](G.a),f["\u0275\u0275directiveInject"](ee.HighlightJsService),f["\u0275\u0275directiveInject"](B.d),f["\u0275\u0275directiveInject"](r.c),f["\u0275\u0275directiveInject"](W.b),f["\u0275\u0275directiveInject"](b.b))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["markdown-markdown-edit"]],viewQuery:function(e,t){if(1&e&&(f["\u0275\u0275viewQuery"](re,1),f["\u0275\u0275viewQuery"](le,1),f["\u0275\u0275viewQuery"](oe,1)),2&e){let e;f["\u0275\u0275queryRefresh"](e=f["\u0275\u0275loadQuery"]())&&(t.elementRef=e.first),f["\u0275\u0275queryRefresh"](e=f["\u0275\u0275loadQuery"]())&&(t.btnClipboard=e.first),f["\u0275\u0275queryRefresh"](e=f["\u0275\u0275loadQuery"]())&&(t.textareaRef=e.first)}},inputs:{loader:"loader"},decls:33,vars:16,consts:function(){let e,t,n,a;return e="New",t="Save sequence",n="Modify",a="Delete",[["data-clipboard-text","",1,"hide"],["btnClipboard",""],["mode","side",1,"sidenav-left",3,"opened"],["mat-list-item","",3,"routerLink"],[3,"sortablejs"],["mat-list-item","",3,"routerLink",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip",e,1,"menu-btn",3,"disabled","click"],["mat-icon-button","","matTooltip",t,1,"menu-btn",3,"disabled","click"],["mode","side","position","end",1,"sidenav-right",3,"opened"],[3,"items","valChange"],[1,"navigate-view"],[3,"routerLink",4,"ngIf"],[1,"navigate-fill"],[1,"title"],[1,"markdown"],["highlight-js-content","code"],["view",""],["textarea",""],["matLine",""],["mat-icon-button","","matTooltip",n,1,"menu-btn",3,"disabled","click"],["mat-icon-button","","matTooltip",a,1,"menu-btn",3,"disabled","click"],[3,"routerLink"],["mat-button","",1,"previous","no-outline"],["mat-button","",1,"next","no-outline"]]},template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"button",0,1),f["\u0275\u0275text"](2,"copy"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](3,"mat-drawer-container"),f["\u0275\u0275elementStart"](4,"mat-drawer",2),f["\u0275\u0275elementStart"](5,"mat-nav-list"),f["\u0275\u0275elementStart"](6,"a",3),f["\u0275\u0275text"](7),f["\u0275\u0275elementEnd"](),f["\u0275\u0275element"](8,"mat-divider"),f["\u0275\u0275elementStart"](9,"div",4),f["\u0275\u0275template"](10,de,9,7,"a",5),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275element"](11,"mat-divider"),f["\u0275\u0275elementStart"](12,"mat-list-item"),f["\u0275\u0275elementStart"](13,"button",6),f["\u0275\u0275listener"]("click",function(){return t.onChapterNew()}),f["\u0275\u0275elementStart"](14,"mat-icon"),f["\u0275\u0275text"](15,"add"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](16,"button",7),f["\u0275\u0275listener"]("click",function(){return t.onChapterSort(t.book)}),f["\u0275\u0275elementStart"](17,"mat-icon"),f["\u0275\u0275text"](18,"sort"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](19,"mat-drawer",8),f["\u0275\u0275elementStart"](20,"markdown-bar",9),f["\u0275\u0275listener"]("valChange",function(e){return t.onChange(e)}),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](21,"mat-drawer-content"),f["\u0275\u0275elementStart"](22,"div",10),f["\u0275\u0275template"](23,se,5,5,"a",11),f["\u0275\u0275elementStart"](24,"div",12),f["\u0275\u0275elementStart"](25,"div",13),f["\u0275\u0275text"](26),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275template"](27,me,5,5,"a",11),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](28,"div",14),f["\u0275\u0275elementStart"](29,"section",15,16),f["\u0275\u0275element"](31,"textarea",null,17),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e&&(f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("opened",!t.fullscreen&&t.chapter),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("routerLink",f["\u0275\u0275pureFunction1"](14,pe,null==t.book?null:t.book.id)),f["\u0275\u0275advance"](1),f["\u0275\u0275textInterpolate"](null==t.book?null:t.book.name),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("sortablejs",null==t.book?null:t.book.chapter),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngForOf",null==t.book?null:t.book.chapter),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",t.disabled),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",t.disabled),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("opened",!t.fullscreen&&t.header),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("items",null==t.markdown?null:t.markdown.Header),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",t.previous),f["\u0275\u0275advance"](3),f["\u0275\u0275textInterpolate"](t.title),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",t.next),f["\u0275\u0275advance"](1),f["\u0275\u0275styleMap"](t.readyEdit?"":"display: none;"))},directives:[te.b,te.a,O.e,O.c,r.d,ne.a,ae.a,a.j,E.a,M.a,z.a,ie.a,te.c,a.k,R.e],styles:[".sidenav-right[_ngcontent-%COMP%]{padding-right:16px}.sidenav-left[_ngcontent-%COMP%], .sidenav-right[_ngcontent-%COMP%]{position:fixed;top:64px;bottom:0;min-width:150px}.sidenav-left[_ngcontent-%COMP%]{left:0;background-color:#fafafa;box-shadow:6px 0 6px #0000001a}.sidenav-tools[_ngcontent-%COMP%]{position:fixed;top:64px;background-color:#fafafa;padding-right:18px}textarea[_ngcontent-%COMP%]{height:100%}.editor-toolbar[_ngcontent-%COMP%]{z-index:1024}.navigate-view[_ngcontent-%COMP%]{display:flex}.navigate-fill[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;align-items:center;align-content:center}.title[_ngcontent-%COMP%]{text-align:center;width:100%}"]}),e})();var be=n("jhN1");function ve(e,t){1&e&&f["\u0275\u0275elementContainer"](0)}function ge(e,t){1&e&&f["\u0275\u0275element"](0,"mat-progress-bar",5)}function Se(e,t){1&e&&f["\u0275\u0275elementContainer"](0)}function Ce(e,t){if(1&e&&f["\u0275\u0275template"](0,Se,1,0,"ng-container",0),2&e){const e=f["\u0275\u0275nextContext"](),t=f["\u0275\u0275reference"](6),n=f["\u0275\u0275reference"](8);f["\u0275\u0275property"]("ngIf",e.error)("ngIfThen",t)("ngIfElse",n)}}function Ee(e,t){if(1&e&&f["\u0275\u0275text"](0),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275textInterpolate1"](" ",e.error,"\n")}}function ye(e,t){if(1&e&&f["\u0275\u0275element"](0,"markdown-markdown-edit",6),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275property"]("loader",e.loader)}}let xe=(()=>{class e{constructor(e,t,n,a){this.httpClient=e,this.i18nService=t,this.title=n,this.settingsService=a,this.loading=!1,this.closed_=new l.a}ngOnInit(){this.settingsService.openedObservable.pipe(Object(o.a)(this.closed_.observable)).subscribe(e=>{this.title.setTitle(this.i18nService.get("Loading"));const t=new c.a(e);this.loader=t,this.loading=!0,t.load(this.httpClient,!0).then(e=>{this.loader==t&&(this.title.setTitle(e),this.settingsService.nextEditPage(),this.loading=!1)},e=>{this.loader==t&&(this.loader=null,this.title.setTitle(this.i18nService.get("Error")),this.error=e,this.loading=!1)})})}ngOnDestroy(){this.closed_.close(),this.settingsService.closeEditPage()}saved(){return!this.child||this.child.saved()}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](W.b),f["\u0275\u0275directiveInject"](G.a),f["\u0275\u0275directiveInject"](be.c),f["\u0275\u0275directiveInject"](Y.b))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["markdown-edit"]],viewQuery:function(e,t){if(1&e&&f["\u0275\u0275viewQuery"](fe,1),2&e){let e;f["\u0275\u0275queryRefresh"](e=f["\u0275\u0275loadQuery"]())&&(t.child=e.first)}},decls:9,vars:3,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["loadingView",""],["readyView",""],["errorView",""],["okView",""],["mode","indeterminate"],[3,"loader"]],template:function(e,t){if(1&e&&(f["\u0275\u0275template"](0,ve,1,0,"ng-container",0),f["\u0275\u0275template"](1,ge,1,0,"ng-template",null,1,f["\u0275\u0275templateRefExtractor"]),f["\u0275\u0275template"](3,Ce,1,3,"ng-template",null,2,f["\u0275\u0275templateRefExtractor"]),f["\u0275\u0275template"](5,Ee,1,1,"ng-template",null,3,f["\u0275\u0275templateRefExtractor"]),f["\u0275\u0275template"](7,ye,1,1,"ng-template",null,4,f["\u0275\u0275templateRefExtractor"])),2&e){const e=f["\u0275\u0275reference"](2),n=f["\u0275\u0275reference"](4);f["\u0275\u0275property"]("ngIf",t.loading)("ngIfThen",e)("ngIfElse",n)}},directives:[a.k,j.a,fe],styles:[""]}),e})();const we=[{path:":book/:chapter",component:(()=>{class e{constructor(e,t){this.activatedRoute=e,this.settingsService=t,this.closed_=new l.a}ngOnInit(){this.activatedRoute.params.pipe(Object(o.a)(this.closed_.observable)).subscribe(e=>{e&&this.settingsService.open(e.book,e.chapter)},e=>{console.warn(e)})}ngOnDestroy(){this.closed_.close()}saved(){return!this.child||this.child.saved()}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](r.a),f["\u0275\u0275directiveInject"](Y.b))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-edit"]],viewQuery:function(e,t){if(1&e&&f["\u0275\u0275viewQuery"](xe,1),2&e){let e;f["\u0275\u0275queryRefresh"](e=f["\u0275\u0275loadQuery"]())&&(t.child=e.first)}},decls:1,vars:0,template:function(e,t){1&e&&f["\u0275\u0275element"](0,"markdown-edit")},directives:[xe],styles:[""]}),e})(),canDeactivate:[(()=>{class e{constructor(){}canDeactivate(e,t,n,a){return e.saved()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=f["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()]}];let ke=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=f["\u0275\u0275defineInjector"]({imports:[[r.e.forChild(we)],r.e]}),e})(),Ie=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=f["\u0275\u0275defineInjector"]({imports:[[a.c,i.a,ke]]}),e})()}}]);